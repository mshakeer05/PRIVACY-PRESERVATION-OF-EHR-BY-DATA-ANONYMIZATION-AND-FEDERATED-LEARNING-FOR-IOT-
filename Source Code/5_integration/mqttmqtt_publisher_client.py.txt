pip install paho-mqtt

import json
import time
import numpy as np
from paho.mqtt import client as mqtt

BROKER = 'localhost'
PORT = 1883
TOPIC = "fl/model_update"

def simulate_model_update(client_id):
    # Simulated local model weights
    weights = {
        "layer1": np.random.rand(3).tolist(),
        "layer2": np.random.rand(3).tolist(),
        "bias1": [np.random.rand()],
        "bias2": [np.random.rand()]
    }
    payload = {
        "client_id": client_id,
        "weights": weights
    }
    return json.dumps(payload)

def publish_model(client_id):
    client = mqtt.Client(f"client_{client_id}")
    client.connect(BROKER, PORT)
    time.sleep(1)

    payload = simulate_model_update(client_id)
    client.publish(TOPIC, payload)
    print(f"[Client-{client_id}] Published model update.")

    client.disconnect()

if __name__ == '__main__':
    for cid in range(1, 6):
        publish_model(cid)
        time.sleep(2)

